<div class="categories-container container mt-4">

  <h2 class="mb-4 text-center">ðŸŽ€ Gestion des catÃ©gories</h2>

  <!-- FORMULAIRE AJOUT / MODIF (admin seulement) -->
  <div *ngIf="isAdmin()" class="mb-3 d-flex gap-2 flex-wrap">
    <input [(ngModel)]="categoryName" class="form-control form-control-pink" placeholder="Nouvelle catÃ©gorie">
    <button *ngIf="!editId" class="btn btn-success btn-pink" (click)="addCategory()">Ajouter</button>
    <button *ngIf="editId" class="btn btn-primary btn-pink" (click)="updateCategory()">Enregistrer</button>
  </div>

  <!-- LISTE DES CATEGORIES -->
  <ul class="list-group">
    <li *ngFor="let cat of categories"
        class="list-group-item d-flex flex-column gap-2 p-3 rounded shadow-sm mb-2">

      <div class="d-flex justify-content-between align-items-center">

        <span (click)="selectCategory(cat)" class="category-name">
          {{ cat.nom }}
        </span>

        <!-- ACTIONS ADMIN -->
        <div class="btn-group" *ngIf="isAdmin()">
          <button class="btn btn-sm btn-outline-primary" (click)="editCategory(cat)">Modifier</button>
          <button class="btn btn-sm btn-outline-danger" (click)="deleteCategory(cat.id)">Supprimer</button>
        </div>

      </div>

      <!-- PRODUITS DE LA CATEGORIE -->
      <ul *ngIf="selectedCategoryId === cat.id && products.length" class="mt-2 list-group list-group-flush rounded">
        <li *ngFor="let p of products" class="list-group-item bg-light">
          {{ p.nom }} - {{ p.prix }} DT
        </li>
      </ul>

      <p *ngIf="selectedCategoryId === cat.id && products.length === 0" class="mt-2 text-muted">
        Aucun produit pour cette catÃ©gorie.
      </p>

    </li>
  </ul>

</div>
