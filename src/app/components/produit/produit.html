<div class="container mt-4">

  <h3 class="text-center mb-4">üõçÔ∏è Gestion des Produits</h3>

  <!-- FORMULAIRE AJOUT / MODIFICATION (admin uniquement) -->
  <form *ngIf="isAdmin()" (ngSubmit)="saveProduit()" class="card card-body mb-4 shadow">

    <div class="mb-3">
      <label class="form-label">Nom du produit</label>
      <input type="text" class="form-control" placeholder="Nom du produit"
             [(ngModel)]="produit.nom" name="nom" required />
    </div>

    <div class="mb-3">
      <label class="form-label">Prix</label>
      <input type="number" class="form-control" placeholder="Prix"
             [(ngModel)]="produit.prix" name="prix" required />
    </div>

    <div class="d-flex gap-2">
      <button type="submit" class="btn btn-success">{{ isEdit ? 'Modifier' : 'Ajouter' }}</button>
      <button type="button" class="btn btn-secondary" *ngIf="isEdit" (click)="resetForm()">Annuler</button>
    </div>
  </form>

  <!-- TABLE DES PRODUITS -->
  <table class="table table-bordered table-striped shadow">
    <thead class="table-dark">
      <tr>
        <th>Nom</th>
        <th>Prix</th>
        <th style="width: 200px">Actions</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let p of produits">
        <td>{{ p.nom }}</td>
        <td>{{ p.prix }} DT</td>
        <td>
          <!-- Admin : CRUD complet -->
          <div *ngIf="isAdmin()" class="btn-group">
            <button class="btn btn-warning btn-sm me-1" (click)="editProduit(p)">Modifier</button>
            <button class="btn btn-danger btn-sm" (click)="deleteProduit(p.id)">Supprimer</button>
          </div>

          <!-- Client : ajout au panier -->
          <button *ngIf="!isAdmin()" class="btn btn-primary btn-sm" (click)="addToPanier(p)">
            Ajouter au panier
          </button>
        </td>
      </tr>
    </tbody>
  </table>

</div>
